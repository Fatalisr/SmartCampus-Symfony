{% extends 'base_technicien.html.twig' %}


{% block title %}Installation{% endblock %}

{% block body %}
    <link rel="stylesheet" href={{ asset('tech_maintenance.css') }}>
    <div class="div_sa_info">
        <div>
            <span>  {{ curSA.name }} </span>
        </div>
        <div>
            {% if curSA.oldRoom is not null %}
                <h2>Salle actuelle :</h2>
                <p>{{  curSA.oldRoom.name }}</p>
            {% endif %}
            <h2>A installer en salle :</h2>
            <span> {{ curSA.currentRoom.name }} </span>
        </div>
    </div>
    <div class="div_sa_info">
        <div>
            <h2>Etapes de l'installation :</h2>
            <ol>
                <li>Branchement du système d'acquisition</li>
                <li>Configuration</li>
                <li>Test des données remontées</li>
            </ol>
        </div>
    </div>
    {{ form_start(formValidInstallation, {'attr' : {'id' : 'maintenance_form'}}) }}
    <div id="block_ref_msg">
        <div class="ref_msg">
            <h2>Retour d'installation :</h2>
            <p>{{ form_widget(formValidInstallation.report) }}</p>
        </div>
    </div>
    <div id="block_btns">
        <button id="valid_btn" type="button" onclick="sendformulaire('true')">VALIDER L'INSTALLATION</button>
        <button id="invalid_btn" type="button" onclick="sendformulaire('false')">INSTALLATION IMPOSSIBLE</button>
    </div>
    <div>
        <span id="err_sub">Veuillez completer le rapport d'installation</span>
    </div>

    {{ form_end(formValidInstallation) }}

    <script>
        function sendformulaire(valid){
            let data = document.getElementById('maintenance_form_valid');
            let textareaContent = document.getElementById('maintenance_form_report').value;
            if(textareaContent.trim() !== ''){
                if(valid === 'true'){
                    data.value = 'true';
                }else{
                    data.value = 'false';
                }
                document.getElementById('maintenance_form').submit();
            }else{
                document.getElementById('err_sub').style.display = 'flex';
            }
        }
    </script>


{% endblock %}
